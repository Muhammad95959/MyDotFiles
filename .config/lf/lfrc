set cleaner '~/.config/lf/cleaner.sh'
set drawbox
set hidden
set icons
set mouse
set number
set period 1
set previewer '~/.config/lf/previewer.sh'

source '~/.config/lf/opener'

cmd touch $touch "$(echo $* | tr ' ' '\ ')"
cmd mkdir $mkdir -p "$(echo $* | tr ' ' '\ ')"
cmd copypath $printf "%s" "$fx" | xclip -selection clipboard
cmd copyname $printf "%s" "$fx" | awk -F "/" '{print $NF}' | xclip -selection clipboard

cmd trash &{{
confirm=$(echo -e " Yes\n No" | \
  rofi -theme-str 'window {location: center; anchor: center; fullscreen: false; width: 250px;}' \
		-theme-str 'mainbox {children: [ "message", "listview" ];}' \
		-theme-str 'listview {columns: 2; lines: 1;}' \
		-theme-str 'element-text {horizontal-align: 0.5;}' \
		-theme-str 'textbox {horizontal-align: 0.5;}' \
		-dmenu \
		-p 'Confirmation' \
		-mesg 'Are you Sure?' \
		-theme $HOME/.config/rofi/scripts/powermenu/type-1/style-2.rasi)
  [ "$confirm" == " Yes" ] && trash $fx
	lf -remote "send $id reload"
}}

cmd chmod+x &{{
	chmod u+x $fx
	lf -remote "send $id reload"
}}

cmd chmod-x &{{
	chmod -x $fx
	lf -remote "send $id reload"
}}

cmd extract ${{
    set -f
    case $f in
        *.tar.bz|*.tar.bz2|*.tbz|*.tbz2) tar xjvf $f;;
        *.tar.gz|*.tgz) tar xzvf $f;;
        *.tar.xz|*.txz) tar xJvf $f;;
        *.zip) unzip $f;;
        *.rar) unrar x $f;;
        *.7z) 7z x $f;;
    esac
}}

cmd paste-override &{{
	set -f
	load=$(lf -remote "load")
	mode=$(echo "$load" | head -1)
	list=$(echo "$load" | sed '1d')
	set -- _ $list; shift
	[ $# -gt 0 ] || exit
	case $mode in
		copy)
			rsync -r "$@" ./
			;;
		move)
			rsync -r --remove-source-files "$@" ./
			;;
	esac
	lf -remote 'save\nmove\n'
	lf -remote "send $id load"
	lf -remote "send $id echo \"\033[0;32mpasted $# file(s)\033[0m\""
}}

cmd paste_link %{{
	IFS='
'
	set -- $(cat ~/.local/share/lf/files)
	mode="$1"
	shift
	if [ $# -lt 1 ]; then
		lf -remote "send $id echo no files to link"
		exit 1
	fi
	case "$mode" in
		# symbolically copy mode is indicating a soft link
		copy) ln -sr -t . -- "$@";;
		# while a move mode is indicating a hard link
		move) ln -t . -- "$@";;
	esac \
		|| exit $?
	rm ~/.local/share/lf/files
	lf -remote "send clear"
}}

# Command mode
cmap <a-a> cmd-end
cmap <a-i> cmd-home
cmap <tab> cmd-menu-complete
cmap <backtab> cmd-menu-complete-back

# Unmapping default maps
map c
map d
map gh
map p
map r
map u
map y

map <enter> open
map <esc> clear
map ? maps
map A push a<a-a>
map E extract
map O openwith
map T &thunar $fx
map W &{ nohup "${TERMINAL:-kitty}" >/dev/null 2>&1& }
map a rename
map br $vimv $fx
map cX chmod-x
map cw &nitrogen --head=0 --set-zoom-fill $f
map cx chmod+x
map dD trash
map dd cut
map dr &dragon-drop -a -x $fx
map i push a<a-i>
map pl paste_link
map po paste-override
map pp paste
map uv unselect
map V invert-below
map yn copyname
map yp copypath
map yy copy

# Navigation
map gda cd "/home/muhammad/Disk_D/برامج"
map gdb cd "/mnt/Disk_D/Backgrounds"
map gdd cd "/mnt/Disk_D/مستندات"
map gde cd "/mnt/Disk_D/تعليمي"
map gdg cd "/mnt/Disk_D/Engineering"
map gdi cd "/mnt/Disk_D/إسلاميات"
map gdl cd "/mnt/Disk_D/Muhammad/Linux_stuff"
map gdm cd "/mnt/Disk_D/Muhammad"
map gdn cd "/mnt/Disk_D/Muhammad/My_Documents"
map gdp cd "/mnt/Disk_D/Projects & Designs"
map gdq cd "/mnt/Disk_D/قرآن كريم"
map gdr cd "/mnt/Disk_D/Muhammad/Repositories"
map gds cd "/mnt/Disk_D/Muhammad/Linux_stuff/Scripts"
map ghP cd "/home/muhammad/Projects"
map gha cd "/home/muhammad/.ASProjects"
map ghc cd "/home/muhammad/.config"
map ghd cd "/home/muhammad/Downloads"
map ghf cd "/home/muhammad/.fonts"
map ghh cd "/home/muhammad"
map ghi cd "/home/muhammad/.IdeaProjects"
map ghl cd "/home/muhammad/.local/share"
map ghp cd "/home/muhammad/Pictures"
map ghs cd "/home/muhammad/Scripts"
map gm  cd "/run/media/muhammad"
map gr  cd "/"
map gs  cd "/mnt/Disk_D/Virtual Machines/Share"
